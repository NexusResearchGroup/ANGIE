<html>
<head>
<title>NetworkGrowthCom2</title>
<style type="text/css">
<!--
  :link { color: rgb(110, 0, 110); } 
  :visited { color: rgb(110, 0, 110); } 
  body { margin-left: 5px; font-family: arial, sans-serif; 
         background: white; font-size: 12pt } 
  h2 { background: rgb(166,172,255); 
       font-size: 15pt; 
       padding-left: 6px; padding-right: 6px; padding-top: 6px; 
       padding-bottom: 6px; } 
  p { margin-left: 10px; } 
  pre { margin-left: 13px; background: rgb(225,225,225); 
        font-family: monospace; padding-left: 3px; padding-right: 3px; 
        padding-top: 3px; padding-bottom: 3px; } 
-->
</style>
</head>
<body>

<p>This page was automatically generated by NetLogo 4.1.3.</p>

<p>The applet requires Java 5 or higher.
Java must be enabled in your browser settings.
Mac users must have Mac OS X 10.4 or higher.
Windows and Linux users may obtain the latest Java from
<a href="http://java.sun.com/getjava/download.html">Sun's Java site</a>.</p>

<p><hr>

<p><font size="-1">In order for this to work, this file, your model file
(NetworkGrowthCom2.nlogo), and the file NetLogoLite.jar
must all be in the same directory.  (You can copy NetLogoLite.jar
from the directory where you installed NetLogo.)</font></p>

<p><font size="-1">The applet will also need access to the gis extension.
Copy the entire directory for each required extension into the same
directory as the applet.</font></p>

<p><font size="-1">On some systems, you can test the applet locally on your computer
before uploading it to a web server.  It doesn't work on all systems,
though, so if it doesn't work from your hard drive, please try
uploading it to a web server.</font></p>

<p><font size="-1">You don't need to include everything in this file in your page.
If you want, you can just take the HTML code beginning with
&lt;applet&gt; and ending with &lt;/applet&gt;, and paste it into any HTML
file you want.  It's even OK to put multiple &lt;applet&gt; tags
on a single page.</font></p>

<p><font size="-1">If NetLogoLite.jar and your model are in different
directories, you must modify the archive= and value= lines
in the HTML code to point to their actual locations.
(For example, if you have multiple applets in different
directories on the same web server, you may want to put 
a single copy of NetLogoLite.jar in one central place and
change the archive= lines of all the HTML files to point
to that one central copy.  This will save disk space for
you and download time for your users.)</font></p>

<p>
<applet code="org.nlogo.lite.Applet"
        archive="NetLogoLite.jar,gis\gis.jar,gis\jai_codec-1.1.3.jar,gis\jai_core-1.1.3.jar,gis\jscience-4.2.jar,gis\jts-1.9.jar,gis\commons-codec-1.3.jar,gis\commons-logging-1.1.jar,gis\commons-httpclient-3.0.1.jar"
        width="1784" height="815">
  <param name="DefaultModel"
         value="NetworkGrowthCom2.nlogo">
</applet>
</p>

<p>powered by
<a target="_blank" href="http://ccl.northwestern.edu/netlogo/">NetLogo</a></p>

<p>view/download model file:
<a href="NetworkGrowthCom2.nlogo">NetworkGrowthCom2.nlogo</a>
</p>
<h2>WHAT IS IT?</h2>
<p>This applet models the growth of networks in several scenarios such as an artifical grid-like city and the Minneapolis skyway system. The philosophy inherent in these models is that accessibility affects network growth and vertice versa. Different values of accessibility at individual locations may lead to different network structures. </p><br>
<h2>HOW IT WORKS</h2>
<p>A sky assumption in these models is that the network is built from bottom to up, driven by individual investors' intention to maximize their benefits. The models in the five scenarios have the same mechanism. Here let's take the skyway scenario as an example. </p>
<p>The edges of the network are called segments, and the vertices are buildings. The edges of the network are skyway segments, and the vertices are buildings. Let's assume the value of accessibility for building owner i to build a new segment k in round t equals:</p>
<p>A_i(k,t)= \sum_{j=1}^J w * beta_{j,t} *d_{ij,t}^{- delta}</p>
<p>where d_{ij,t} is the shortest network distance between vertices i and j. delta is a distance decay parameter, indicating that a longer travel path lowers the value of accessibility. $w$ is the value of accessing one employee. beta_{j, t} represents the total number of employees in building $j$ in iteration t, which is assumed to be proportional to the area of office space in building j. Since the employees' data are not available for verification, this assumption is only approximately true, but it serves as a plausible start. In addition, since the office space of a building in reality evolved over time, in simulation each iteration's beta_{j, t} is updated using the office space data for building j in a corresponding year. </p>
<p>For building owner i, the incentive to build segment k is measured as the increased value of accessibility due to this new segment. The disincentive is the cost of building and maintaining segment $k$ which is presumably proportional to its length. The marginal benefit for building owner $i$ to build segment k is the difference between the incentive and disincentive, which can be described as:</p>
<p>Delta p_i (k, t) = A_i (k, t) - A_i (k, t-1) - c * l_k</p>
<p>where l_k is the length of segment k and c is the unit cost of segment k. Among all possible segments to be built, building owner i selects the segment that provides the highest marginal benefit. If the highest marginal benefit is greater than zero, a segment will be built; otherwise no segment will be built. This is thus a locally selfish, myopic optimization, maximizing short-term benefit for the building owner himself. In deciding the segment candidates for each building owner, we rule out the segments which cannot be built because of specific uses of certain buildings (e.g., government administrative building). </p>
<p>By setting different values of the paramters of the network, the users can test how different values of parameters affect the network structure. </p>
<p>To quantify the similarity between the modeled network and the actual network, we propose a matching index which rewards the matched segments and penalizes the mismatched segments. It equals:</p>
<p>rho = \frac{alpha}{M} - (1- \frac{alpha}{T})</p>
<p>where alpha is the number of simulated skyway segments matching the actual network; M is the total number of simulated skyway segments; T indicates the total number of actual skyway segments. The higher rho is, the more similar the generated network is to the actual network. </p><br>
<h2>HOW TO USE IT</h2>
<p>There are four scenarios that can be tested: a sigle-center grid-like city, a two-center grid-like city, a four-center grid-like city, a nine-center grid-like city , and the Minneapolis skyway system. After selecting the scenario from the Scenario Panel, click &quot;Setup&quot; button to intitate the designated pattern. </p>
<p>Two variables are common in all four scenarios: distance decay parameter (beta) and the unit cost of segment construction. Distance decay parameter is the exponential term of the network distance between two locations in the accessibility function. When used in the function, the actual value is the negative form of the input, which means that longer travel distance decreases the value of accessibility. The unit cost of segment construction are defined slightly different for the grid-like model and the skyway model. In the grid-like model, since all the links have the same length, the unit cost of segment construction represents the cost of building a link; however, in the Minneapolis skyway model, the unit cost of segment construction represents the cost of bulindg a link per meter, considering the fact that the lengths of the segments are different. </p>
<p>The grid-like city models and the Minneapolis skyway model also have different input variables. In the grid-like city models, users can set up grid size, scale, the value of accessibility of a center, and the value of accessibility of an ordinary location. Grid size indicates the number of locations in a row or column. The scale variable can change the relative distance of adjacent locations. Since the unit cost of builging a link in the grid-like city models is only set by users, the scale variable does not affect the outputs of the models, but only serves to help visually present the outputs. In the skyway model, we assume all buildings have the same value of accessibility per employee, which is indicated by unitbenefit_p. </p><br>
<h2>THINGS TO NOTICE</h2>
<p>This section could give some ideas of things for the user to notice while running the model.</p><br>
<h2>THINGS TO TRY</h2>
<p>This section could give some ideas of things for the user to try to do (move sliders, switches, etc.) with the model.</p><br>
<h2>OTHER FEATURES</h2>
<p>In the skyway network scenario, users can select the google map of downtown Minneapolis as the background by clicking &quot;change background&quot;, and clear the background by clicking &quot;clear background&quot;.</p><br>
<h2>CREDITS AND REFERENCES</h2>
<p>The details about the models can be found in the following two papers:</p>
<p>Levinson, D. and Huang, A. (2012) A Positive Theory of Network Connectivity. Environment and Planning B (in press) URL: <a href="http://nexus.umn.edu/Papers/TheoryOfConnectivity.pdf">http://nexus.umn.edu/Papers/TheoryOfConnectivity.pdf</a></p>
<p>Huang, A. and Levinson, D. (2012)  The structure and dynamics of a skyway network. The European Physical Journal: Speical issue (in press) </p><br>
<h2>PROCEDURES</h2>
<pre><font color="#5a5a5a">;;</font><font color="#000000">
</font><font color="#5a5a5a">;; Model: agent-based modeling the network growth and the Minneapolis skyway network</font><font color="#000000">
</font><font color="#5a5a5a">;; The forumlation of the models can be found in the papers</font><font color="#000000">
</font><font color="#5a5a5a">;; &quot;A positive theory of network connectiviy&quot; and</font><font color="#000000">
</font><font color="#5a5a5a">;; &quot;The structure and dynamics of a skyway network&quot;</font><font color="#000000">
</font><font color="#5a5a5a">;;  Date: April 12, 2012 </font><font color="#000000">
</font><font color="#5a5a5a">;;  Questions about the code can be sent to Arthur Huang at huang284@umn.edu </font><font color="#000000">
</font><font color="#5a5a5a">;;</font><font color="#000000">

</font><font color="#007f69">extensions</font><font color="#000000"> [gis]
</font><font color="#007f69">globals</font><font color="#000000"> 
  [  
   </font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">
   </font><font color="#5a5a5a">;; global variables   ;;;;;;;;;;</font><font color="#000000">
   </font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">
  nodes-dataset skyways-dataset block-dataset
    completelinks-dataset
    infinity  </font><font color="#5a5a5a">;; a very large number</font><font color="#000000">
   sequence 
   </font><font color="#5a5a5a">;cost</font><font color="#000000">
   roadness</font><font color="#5a5a5a">;; list of nodes that have the minimum x or y</font><font color="#000000">
              </font><font color="#5a5a5a">;; this is used to calculate roadness</font><font color="#000000">
   totalEfficiency  </font><font color="#5a5a5a">;; total network efficiency</font><font color="#000000">
   avgCoeff  </font><font color="#5a5a5a">;; average clustering coefficient </font><font color="#000000">
   node-start  </font><font color="#5a5a5a">;; a node to start a link</font><font color="#000000">
   node-end    </font><font color="#5a5a5a">;; a node at the end of a link </font><font color="#000000">
   </font><font color="#5a5a5a">;unitedgecost</font><font color="#000000">
   outputlinks
   matchratio
   totmatchratio 
   </font><font color="#5a5a5a">;delta</font><font color="#000000">
   matchratio-list 
   actualmatchlinks 
   connect
   degree-centrality
   closeness-centrality 
   straightness-centrality
   
  ]
  
</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  </font><font color="#000000">
</font><font color="#5a5a5a">;;agents in the skyway model</font><font color="#000000">
</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">
</font><font color="#660096">breed</font><font color="#000000"> [buildings building]
</font><font color="#007f69">undirected-link-breed</font><font color="#000000"> [skyways skyway]
</font><font color="#007f69">undirected-link-breed</font><font color="#000000"> [simulinks simulink]
</font><font color="#007f69">undirected-link-breed</font><font color="#000000"> [completelinks completelink]
</font><font color="#007f69">undirected-link-breed</font><font color="#000000"> [ roads road]

</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">
</font><font color="#5a5a5a">;;agents in gried-like city models</font><font color="#000000">
</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">
</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">
</font><font color="#660096">breed</font><font color="#000000"> [locations location]

</font><font color="#5a5a5a">;; variables in the skyway agents</font><font color="#000000">
</font><font color="#007f69">skyways-own</font><font color="#000000">
[
    origin
    destination
    len
    year
 ]

</font><font color="#5a5a5a">; varialbes in the building agents</font><font color="#000000">


</font><font color="#007f69">buildings-own</font><font color="#000000">
[
  rand
  distance-from-other-buildings </font><font color="#5a5a5a">;; weight of each edge (0 stands for connecting to itself, infinity stands for no connection)</font><font color="#000000">
  profit-list </font><font color="#5a5a5a">;; list of profits to each node</font><font color="#000000">
  node-candidate-list </font><font color="#5a5a5a">;; list of nodes to be connected for each round </font><font color="#000000">
                      </font><font color="#5a5a5a">;; the sequence of the members in the list is the same as the profit-list</font><font color="#000000">
  accessiblity  </font><font color="#5a5a5a">;; profit from the whole network</font><font color="#000000">
  num-of-neibor 
  closeness  
  betweeness
  </font><font color="#5a5a5a">;cost</font><font color="#000000">
  straightness
  nodelist </font><font color="#5a5a5a">;; list of nodes to be added (corresponding to the profit list)</font><font color="#000000">
  sum_of_straightness
  information  
  marginalProfitlist
  firstconnectyear
  space-list 
  </font><font color="#5a5a5a">;profitInLastRound</font><font color="#000000">
  prev   </font><font color="#5a5a5a">;; list of previous nodes in a shortest path</font><font color="#000000">
  </font><font color="#5a5a5a">;; all the nodes on the shortest path</font><font color="#000000">
  shortest-path-nodes 
  connectedList </font><font color="#5a5a5a">;; a list of that can be connected (it documents the nearest four nodesw)</font><font color="#000000">
  employee  </font><font color="#5a5a5a">;; employees in a building</font><font color="#000000">
  </font><font color="#5a5a5a">;searched  ;; index to see if a building has been searched before in comparing generated network with actual network</font><font color="#000000">
   space1962  space1963  space1964  space1965  space1966  space1967  space1968  space1969  space1970  space1971  space1972  space1973  space1974  space1975  space1976  space1977  space1978 
   space1979  space1980  space1981  space1982  space1983  space1984  space1985  space1986  space1987  space1988  
   space1989  space1990  space1991  space1992  space1993  space1994  space1995  space1996  space1997  space1998  
   space1999  space2000  space2001  space2002  
   space
   blockID
] 

</font><font color="#5a5a5a">; variables in the location agents</font><font color="#000000">
</font><font color="#007f69">locations-own</font><font color="#000000">
[
  rand
  distance-from-other-locations </font><font color="#5a5a5a">;; weight of each edge (0 stands for connecting to itself, infinity stands for no connection)</font><font color="#000000">
  profit-list </font><font color="#5a5a5a">;; list of profits to each node</font><font color="#000000">
  node-candidate-list </font><font color="#5a5a5a">;; list of nodes to be connected for each round </font><font color="#000000">
                      </font><font color="#5a5a5a">;; the sequence of the members in the list is the same as the profit-list</font><font color="#000000">
  accessiblity  </font><font color="#5a5a5a">;; profit from the whole network</font><font color="#000000">
  num-of-neibor 
  closeness  
  betweeness
  </font><font color="#5a5a5a">;cost</font><font color="#000000">
  straightness
  nodelist </font><font color="#5a5a5a">;; list of nodes to be added (corresponding to the profit list)</font><font color="#000000">
  sum_of_straightness
  information  
  marginalProfitlist
  firstconnectyear
  space-list 
  </font><font color="#5a5a5a">;profitInLastRound</font><font color="#000000">
  prev   </font><font color="#5a5a5a">;; list of previous nodes in a shortest path</font><font color="#000000">
  </font><font color="#5a5a5a">;; all the nodes on the shortest path</font><font color="#000000">
  shortest-path-nodes 
  connectedList </font><font color="#5a5a5a">;; a list of that can be connected (it documents the nearest four nodesw)</font><font color="#000000">
  employee  </font><font color="#5a5a5a">;; employees in a building</font><font color="#000000">
  </font><font color="#5a5a5a">;searched  ;; index to see if a building has been searched before in comparing generated network with actual network</font><font color="#000000">
]


</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">
</font><font color="#5a5a5a">;;;;;set up the landscape given different choices  ;;;;</font><font color="#000000">
</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> setup
  
  
  </font><font color="#0000aa">set</font><font color="#000000"> infinity </font><font color="#963700">9999999999</font><font color="#000000">  </font><font color="#5a5a5a">;; set infinity to be a very large number</font><font color="#000000">
  </font><font color="#5a5a5a">;set totalEfficiency  0</font><font color="#000000">
  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">white</font><font color="#000000">]

  </font><font color="#0000aa">ifelse</font><font color="#000000"> Scenario </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;Minneapolis skway&quot;</font><font color="#000000">
  [ setup-skyway-scenario ]
  [ setup-gridcity-scenario]

</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> setup-gridcity-scenario
  </font><font color="#0000aa">clear-all</font><font color="#000000">
  </font><font color="#0000aa">clear-patches</font><font color="#000000">
  </font><font color="#0000aa">clear-drawing</font><font color="#000000">
  </font><font color="#0000aa">clear-all-plots</font><font color="#000000">
  </font><font color="#0000aa">clear-output</font><font color="#000000">
  </font><font color="#0000aa">set-default-shape</font><font color="#000000"> locations </font><font color="#963700">&quot;circle&quot;</font><font color="#000000">
  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">white</font><font color="#000000">]
  </font><font color="#5a5a5a">;; sprout breed number [commands]: create a lcoation </font><font color="#000000">
  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">abs</font><font color="#000000"> </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> (grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">abs</font><font color="#000000"> </font><font color="#660096">pycor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> (grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">)] [ sprout-locations </font><font color="#963700">1</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">green</font><font color="#000000"> ] ]
  </font><font color="#0000aa">ask</font><font color="#000000"> locations [</font><font color="#0000aa">setxy</font><font color="#000000"> ( </font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> scale) ( </font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> scale)  </font><font color="#0000aa">set</font><font color="#000000"> accessiblity </font><font color="#963700">0</font><font color="#000000">  </font><font color="#0000aa">set</font><font color="#000000"> marginalProfitlist [] </font><font color="#0000aa">set</font><font color="#000000"> distance-from-other-locations [] </font><font color="#0000aa">set</font><font color="#000000"> shortest-path-nodes  []  </font><font color="#0000aa">set</font><font color="#000000"> nodelist [] </font><font color="#0000aa">set</font><font color="#000000"> connectedList []]
  
  
  </font><font color="#0000aa">ifelse</font><font color="#000000"> Scenario </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;Single-center grid-like city&quot;</font><font color="#000000">
  [ </font><font color="#0000aa">ask</font><font color="#000000"> locations [    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">   [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">  </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">]]]
  [ </font><font color="#0000aa">ifelse</font><font color="#000000"> Scenario </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;Two-center grid-like city&quot;</font><font color="#000000"> [</font><font color="#0000aa">ask</font><font color="#000000"> locations [ </font><font color="#0000aa">if</font><font color="#000000"> ( </font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">-1</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale  </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000"> ( </font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">)  [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">  </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] ]]
    [ </font><font color="#0000aa">ifelse</font><font color="#000000"> Scenario </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;Four-center grid-like city&quot;</font><font color="#000000"> [</font><font color="#0000aa">ask</font><font color="#000000"> locations [  </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">-1</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000"> ( </font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000">  </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000"> (</font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">-1</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale) </font><font color="#660096">or</font><font color="#000000"> (</font><font color="#660096">xcor</font><font color="#000000">  </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale)  [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">  </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] ]]
      [  </font><font color="#0000aa">if</font><font color="#000000"> Scenario </font><font color="#660096">=</font><font color="#000000">  </font><font color="#963700">&quot;Nine-center grid-like city&quot;</font><font color="#000000"> [
           </font><font color="#0000aa">ask</font><font color="#000000"> locations [  </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">-1</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000"> ( </font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000">  </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000"> (</font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">-1</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale) </font><font color="#660096">or</font><font color="#000000"> (</font><font color="#660096">xcor</font><font color="#000000">  </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale)  
           </font><font color="#660096">or</font><font color="#000000"> (</font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">-1</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale) </font><font color="#660096">or</font><font color="#000000">  (</font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000">  </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale) </font><font color="#660096">or</font><font color="#000000"> ( </font><font color="#660096">xcor</font><font color="#000000">  </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) 
           </font><font color="#660096">or</font><font color="#000000">  (</font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000">  </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale) </font><font color="#660096">or</font><font color="#000000"> (</font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000">  </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">-1</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale) </font><font color="#660096">or</font><font color="#000000"> (</font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000">  </font><font color="#963700">-1</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">-1</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale)
          [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">  </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] ]]]]]
  
  
  construct-connectedList_for_locations
  
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> setup-skyway-scenario
   </font><font color="#0000aa">clear-all</font><font color="#000000">
   </font><font color="#0000aa">clear-patches</font><font color="#000000">
   </font><font color="#0000aa">clear-drawing</font><font color="#000000">
   </font><font color="#0000aa">clear-all-plots</font><font color="#000000">
   </font><font color="#0000aa">clear-output</font><font color="#000000">
    </font><font color="#0000aa">set-default-shape</font><font color="#000000"> buildings </font><font color="#963700">&quot;circle&quot;</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> matchratio-list []
    </font><font color="#0000aa">set</font><font color="#000000"> infinity </font><font color="#963700">999999</font><font color="#000000">  </font><font color="#5a5a5a">; just set a large value</font><font color="#000000">
    </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">white</font><font color="#000000">]
    </font><font color="#0000aa">set</font><font color="#000000"> nodes-dataset </font><font color="#660096">gis:load-dataset</font><font color="#000000"> </font><font color="#963700">&quot;centroids_new2_SpatialJoin7.shp&quot;</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> skyways-dataset  </font><font color="#660096">gis:load-dataset</font><font color="#000000"> </font><font color="#963700">&quot;downtown_skyways2.shp&quot;</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> block-dataset  </font><font color="#660096">gis:load-dataset</font><font color="#000000"> </font><font color="#963700">&quot;potentialblocks.shp&quot;</font><font color="#000000">
     </font><font color="#0000aa">set</font><font color="#000000"> completelinks-dataset  </font><font color="#660096">gis:load-dataset</font><font color="#000000"> </font><font color="#963700">&quot;complete_downtown_network.shp&quot;</font><font color="#000000">
    </font><font color="#5a5a5a">;gis:set-world-envelope ((gis:envelope-of skyway-dataset))</font><font color="#000000">
    </font><font color="#0000aa">gis:set-world-envelope</font><font color="#000000"> (</font><font color="#660096">gis:envelope-union-of</font><font color="#000000"> (</font><font color="#660096">gis:envelope-of</font><font color="#000000"> nodes-dataset) (</font><font color="#660096">gis:envelope-of</font><font color="#000000"> skyways-dataset) (</font><font color="#660096">gis:envelope-of</font><font color="#000000"> block-dataset) (</font><font color="#660096">gis:envelope-of</font><font color="#000000"> completelinks-dataset) )
    
    </font><font color="#5a5a5a">; show downtown street   </font><font color="#000000">
    </font><font color="#0000aa">ifelse</font><font color="#000000"> show_downtown_streets 
    [ </font><font color="#0000aa">import-drawing</font><font color="#000000"> </font><font color="#963700">&quot;environment3.jpg&quot;</font><font color="#000000"> ]
    [ </font><font color="#0000aa">clear-drawing</font><font color="#000000">  ]   
                                
    display-buildings
    import-skyways
    import-completelinks
    construct-connectedList
    
    </font><font color="#0000aa">ifelse</font><font color="#000000"> show_actual_skyways
    [ </font><font color="#0000aa">ask</font><font color="#000000"> skyways [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000"> </font><font color="#0000aa">show-link</font><font color="#000000">] ]
    [ </font><font color="#0000aa">ask</font><font color="#000000"> skyways [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000"> </font><font color="#0000aa">hide-link</font><font color="#000000">]]
    

</font><font color="#007f69">end</font><font color="#000000"> 



</font><font color="#5a5a5a">; the skyway data imported is a turtle, not a link dataset</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> import-skyways
   </font><font color="#0000aa">ask</font><font color="#000000"> skyways [</font><font color="#0000aa">die</font><font color="#000000">]
   
   </font><font color="#0000aa">foreach</font><font color="#000000"> </font><font color="#660096">gis:feature-list-of</font><font color="#000000"> skyways-dataset
   [
      </font><font color="#0000aa">let</font><font color="#000000"> o </font><font color="#660096">gis:property-value</font><font color="#000000"> ? </font><font color="#963700">&quot;ORIGIN&quot;</font><font color="#000000">
      </font><font color="#0000aa">let</font><font color="#000000"> d </font><font color="#660096">gis:property-value</font><font color="#000000"> ? </font><font color="#963700">&quot;DESTIN&quot;</font><font color="#000000">
      
      </font><font color="#0000aa">ask</font><font color="#000000"> building (o </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) [    
      create-skyway-with building ( d </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) 
      </font><font color="#5a5a5a">;mark the first link that was built</font><font color="#000000">
      </font><font color="#0000aa">if</font><font color="#000000"> firstconnectyear </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> firstconnectyear </font><font color="#660096">&gt;</font><font color="#000000">  </font><font color="#660096">gis:property-value</font><font color="#000000"> ? </font><font color="#963700">&quot;YEAR&quot;</font><font color="#000000">
      [ </font><font color="#0000aa">set</font><font color="#000000"> firstconnectyear (</font><font color="#660096">gis:property-value</font><font color="#000000"> ? </font><font color="#963700">&quot;YEAR&quot;</font><font color="#000000"> )]   
      ] 
      
      </font><font color="#0000aa">ask</font><font color="#000000"> building ( d </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) [ 
       </font><font color="#0000aa">if</font><font color="#000000"> firstconnectyear </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> firstconnectyear </font><font color="#660096">&gt;</font><font color="#000000">  </font><font color="#660096">gis:property-value</font><font color="#000000"> ? </font><font color="#963700">&quot;YEAR&quot;</font><font color="#000000">
      [ </font><font color="#0000aa">set</font><font color="#000000"> firstconnectyear (</font><font color="#660096">gis:property-value</font><font color="#000000"> ? </font><font color="#963700">&quot;YEAR&quot;</font><font color="#000000"> )]]
      
      </font><font color="#0000aa">ask</font><font color="#000000"> skyway (o </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) (d </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)  [   </font><font color="#0000aa">hide-link</font><font color="#000000">
                                      </font><font color="#0000aa">set</font><font color="#000000"> year </font><font color="#660096">gis:property-value</font><font color="#000000"> ? </font><font color="#963700">&quot;YEAR&quot;</font><font color="#000000">  
                                      </font><font color="#0000aa">set</font><font color="#000000"> len </font><font color="#660096">gis:property-value</font><font color="#000000"> ? </font><font color="#963700">&quot;length&quot;</font><font color="#000000"> ]]  
</font><font color="#007f69">end</font><font color="#000000"> 


</font><font color="#5a5a5a">;to display-actual-skyway</font><font color="#000000">
</font><font color="#5a5a5a">;  if Scenario = &quot;Minneapolis skway&quot;</font><font color="#000000">
 </font><font color="#5a5a5a">; [ ask skyways [set color black show-link]]</font><font color="#000000">
</font><font color="#5a5a5a">;end</font><font color="#000000">

</font><font color="#5a5a5a">;to hide-actual-skyway</font><font color="#000000">
</font><font color="#5a5a5a">;   ask skyways [set color black hide-link]</font><font color="#000000">
</font><font color="#5a5a5a">;end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> display-buildings
   </font><font color="#0000aa">ask</font><font color="#000000"> buildings [</font><font color="#0000aa">die</font><font color="#000000">]  
   </font><font color="#0000aa">ask</font><font color="#000000"> buildings [  </font><font color="#0000aa">set</font><font color="#000000"> accessiblity </font><font color="#963700">0</font><font color="#000000">  </font><font color="#0000aa">set</font><font color="#000000"> marginalProfitlist [] </font><font color="#0000aa">set</font><font color="#000000"> distance-from-other-buildings [] 
       </font><font color="#0000aa">set</font><font color="#000000"> shortest-path-nodes []  </font><font color="#0000aa">set</font><font color="#000000"> nodelist [] </font><font color="#0000aa">set</font><font color="#000000"> connectedList []  </font><font color="#0000aa">set</font><font color="#000000"> space-list []
       </font><font color="#0000aa">set</font><font color="#000000"> connect </font><font color="#963700">false</font><font color="#000000"> ]
   
   </font><font color="#0000aa">foreach</font><font color="#000000"> </font><font color="#660096">gis:feature-list-of</font><font color="#000000"> nodes-dataset [ 
      </font><font color="#0000aa">let</font><font color="#000000"> centroid </font><font color="#660096">gis:location-of</font><font color="#000000"> </font><font color="#660096">gis:centroid-of</font><font color="#000000"> ?
      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">not</font><font color="#000000"> </font><font color="#660096">empty?</font><font color="#000000"> centroid [  
        create-buildings </font><font color="#963700">1</font><font color="#000000">   [ 
            </font><font color="#5a5a5a">;set employee em</font><font color="#000000">
            </font><font color="#5a5a5a">;set pcolor red</font><font color="#000000">
             </font><font color="#0000aa">set</font><font color="#000000"> space-list []
            </font><font color="#0000aa">gis:set-drawing-color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">
            </font><font color="#0000aa">gis:fill</font><font color="#000000"> ? </font><font color="#963700">3.0</font><font color="#000000">
            </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> centroid
            </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> centroid
            </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">
            </font><font color="#5a5a5a">; import the property value from &quot;Employee&quot;</font><font color="#000000">
            </font><font color="#0000aa">set</font><font color="#000000"> employee </font><font color="#660096">gis:property-value</font><font color="#000000"> ? </font><font color="#963700">&quot;EMP05&quot;</font><font color="#000000">
            </font><font color="#0000aa">set</font><font color="#000000"> blockID  </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;BLOCKID&quot;</font><font color="#000000">   
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> (</font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1962&quot;</font><font color="#000000">) space-list  
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1963&quot;</font><font color="#000000"> space-list  
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1964&quot;</font><font color="#000000"> space-list  
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1965&quot;</font><font color="#000000"> space-list  
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1966&quot;</font><font color="#000000"> space-list  
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1967&quot;</font><font color="#000000"> space-list  
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1968&quot;</font><font color="#000000"> space-list  
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1969&quot;</font><font color="#000000"> space-list  
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1970&quot;</font><font color="#000000"> space-list  
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1971&quot;</font><font color="#000000"> space-list 
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1972&quot;</font><font color="#000000"> space-list  
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1973&quot;</font><font color="#000000"> space-list  
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1974&quot;</font><font color="#000000"> space-list              
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1975&quot;</font><font color="#000000"> space-list              
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1976&quot;</font><font color="#000000"> space-list           
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1977&quot;</font><font color="#000000"> space-list              
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1978&quot;</font><font color="#000000"> space-list             
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1979&quot;</font><font color="#000000"> space-list              
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1980&quot;</font><font color="#000000"> space-list              
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1981&quot;</font><font color="#000000"> space-list              
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1982&quot;</font><font color="#000000"> space-list  
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1983&quot;</font><font color="#000000"> space-list  
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1984&quot;</font><font color="#000000"> space-list  
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1985&quot;</font><font color="#000000"> space-list  
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1986&quot;</font><font color="#000000"> space-list  
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1987&quot;</font><font color="#000000"> space-list  
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1988&quot;</font><font color="#000000"> space-list                 
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1989&quot;</font><font color="#000000"> space-list                
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1990&quot;</font><font color="#000000"> space-list                 
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1991&quot;</font><font color="#000000"> space-list             
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1992&quot;</font><font color="#000000"> space-list      
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1993&quot;</font><font color="#000000"> space-list              
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1994&quot;</font><font color="#000000"> space-list              
             </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1995&quot;</font><font color="#000000"> space-list     
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1996&quot;</font><font color="#000000"> space-list               
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1997&quot;</font><font color="#000000"> space-list     
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1998&quot;</font><font color="#000000"> space-list                        
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space1999&quot;</font><font color="#000000"> space-list                          
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space2000&quot;</font><font color="#000000"> space-list        
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space2001&quot;</font><font color="#000000"> space-list     
            </font><font color="#0000aa">set</font><font color="#000000"> space-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">gis:property-value</font><font color="#000000"> ?  </font><font color="#963700">&quot;space2002&quot;</font><font color="#000000"> space-list   ]]]    
   
</font><font color="#007f69">end</font><font color="#000000"> 

  
</font><font color="#007f69">to</font><font color="#000000"> import-completelinks
  </font><font color="#0000aa">ask</font><font color="#000000"> completelinks [</font><font color="#0000aa">die</font><font color="#000000">] 
  </font><font color="#0000aa">foreach</font><font color="#000000"> </font><font color="#660096">gis:feature-list-of</font><font color="#000000"> completelinks-dataset
  [
     </font><font color="#0000aa">let</font><font color="#000000"> ori </font><font color="#660096">gis:property-value</font><font color="#000000"> ? </font><font color="#963700">&quot;ORIGIN&quot;</font><font color="#000000">
     </font><font color="#0000aa">let</font><font color="#000000"> dest </font><font color="#660096">gis:property-value</font><font color="#000000"> ? </font><font color="#963700">&quot;DESTIN&quot;</font><font color="#000000">
     </font><font color="#0000aa">ask</font><font color="#000000"> building (ori </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) [ create-completelink-with building (dest </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) ]    
     </font><font color="#0000aa">ask</font><font color="#000000"> completelink (ori </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) ( dest </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) [</font><font color="#0000aa">hide-link</font><font color="#000000">]
    ]  
</font><font color="#007f69">end</font><font color="#000000">  

</font><font color="#007f69">to</font><font color="#000000"> construct-connectedList
  
     </font><font color="#0000aa">let</font><font color="#000000"> node </font><font color="#660096">one-of</font><font color="#000000"> buildings
     </font><font color="#0000aa">let</font><font color="#000000"> buildingnum </font><font color="#660096">count</font><font color="#000000">  buildings
     </font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#963700">0</font><font color="#000000">
     </font><font color="#0000aa">while</font><font color="#000000"> [ i </font><font color="#660096">&lt;</font><font color="#000000"> buildingnum ]
     [
        </font><font color="#0000aa">set</font><font color="#000000"> node building i
        </font><font color="#5a5a5a">;; identify nodes without potential to connect</font><font color="#000000">
        </font><font color="#0000aa">ifelse</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">91</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">87</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">88</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">90</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">77</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">93</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">85</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">84</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">79</font><font color="#000000">  </font><font color="#660096">or</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">94</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> 
        i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">103</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">83</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">104</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">82</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">80</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">96</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">81</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">101</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">97</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">89</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">92</font><font color="#000000"> 
        </font><font color="#660096">or</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">98</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">99</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">102</font><font color="#000000"> 
        [ </font><font color="#0000aa">ask</font><font color="#000000"> node  [</font><font color="#0000aa">set</font><font color="#000000"> connectedList []] ]
        </font><font color="#5a5a5a">;; the rest is the completelink neighbors </font><font color="#000000">
        [  </font><font color="#0000aa">ask</font><font color="#000000"> node [</font><font color="#0000aa">set</font><font color="#000000"> connectedList [</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> completelink-neighbors] ] 
    
        </font><font color="#0000aa">set</font><font color="#000000"> i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">  ] 
      </font><font color="#0000aa">ask</font><font color="#000000"> building </font><font color="#963700">10</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> connectedList </font><font color="#660096">remove</font><font color="#000000"> </font><font color="#963700">82</font><font color="#000000"> connectedList]
      </font><font color="#0000aa">ask</font><font color="#000000"> building </font><font color="#963700">14</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> connectedList </font><font color="#660096">remove</font><font color="#000000"> </font><font color="#963700">82</font><font color="#000000"> connectedList]
      </font><font color="#0000aa">ask</font><font color="#000000"> building </font><font color="#963700">19</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> connectedList </font><font color="#660096">remove</font><font color="#000000"> </font><font color="#963700">82</font><font color="#000000"> connectedList]
      </font><font color="#0000aa">ask</font><font color="#000000"> building </font><font color="#963700">64</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> connectedList </font><font color="#660096">remove</font><font color="#000000"> </font><font color="#963700">82</font><font color="#000000"> connectedList]
      
      </font><font color="#0000aa">ask</font><font color="#000000"> building </font><font color="#963700">19</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> connectedList </font><font color="#660096">remove</font><font color="#000000"> </font><font color="#963700">101</font><font color="#000000"> connectedList]
      </font><font color="#0000aa">ask</font><font color="#000000"> building </font><font color="#963700">30</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> connectedList </font><font color="#660096">remove</font><font color="#000000"> </font><font color="#963700">101</font><font color="#000000"> connectedList]
      </font><font color="#0000aa">ask</font><font color="#000000"> building </font><font color="#963700">37</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> connectedList </font><font color="#660096">remove</font><font color="#000000"> </font><font color="#963700">101</font><font color="#000000"> connectedList]
      </font><font color="#0000aa">ask</font><font color="#000000"> building </font><font color="#963700">31</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> connectedList </font><font color="#660096">remove</font><font color="#000000"> </font><font color="#963700">101</font><font color="#000000"> connectedList]    
      
      </font><font color="#0000aa">ask</font><font color="#000000"> building </font><font color="#963700">44</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> connectedList </font><font color="#660096">remove</font><font color="#000000"> </font><font color="#963700">83</font><font color="#000000"> connectedList] 
      </font><font color="#0000aa">ask</font><font color="#000000"> building </font><font color="#963700">50</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> connectedList </font><font color="#660096">remove</font><font color="#000000"> </font><font color="#963700">83</font><font color="#000000"> connectedList] 
      </font><font color="#0000aa">ask</font><font color="#000000"> building </font><font color="#963700">54</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> connectedList </font><font color="#660096">remove</font><font color="#000000"> </font><font color="#963700">83</font><font color="#000000"> connectedList] 
      </font><font color="#0000aa">ask</font><font color="#000000"> building </font><font color="#963700">68</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> connectedList </font><font color="#660096">remove</font><font color="#000000"> </font><font color="#963700">83</font><font color="#000000"> connectedList] 
      </font><font color="#5a5a5a">;ask buildings [set connectedList [self] of completelink-neighbors]</font><font color="#000000">
      </font><font color="#5a5a5a">;output-show [connectedList] of building 91</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">


</font><font color="#007f69">to</font><font color="#000000"> construct-connectedList_for_locations
     </font><font color="#0000aa">let</font><font color="#000000"> node </font><font color="#660096">one-of</font><font color="#000000"> locations
     </font><font color="#0000aa">ask</font><font color="#000000"> locations [</font><font color="#0000aa">set</font><font color="#000000"> connectedList []]
     </font><font color="#0000aa">let</font><font color="#000000"> locationnum </font><font color="#660096">count</font><font color="#000000"> locations
     </font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#963700">0</font><font color="#000000">  
     </font><font color="#0000aa">while</font><font color="#000000"> [i </font><font color="#660096">&lt;</font><font color="#000000"> locationnum]
     [ 
         </font><font color="#0000aa">set</font><font color="#000000"> node location i
         </font><font color="#0000aa">let</font><font color="#000000"> j </font><font color="#963700">0</font><font color="#000000">
         </font><font color="#0000aa">while</font><font color="#000000"> [ j </font><font color="#660096">&lt;</font><font color="#000000"> locationnum]
         [
            </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">distance</font><font color="#000000"> node] </font><font color="#660096">of</font><font color="#000000"> location j </font><font color="#660096">=</font><font color="#000000"> scale
            [ </font><font color="#0000aa">ask</font><font color="#000000"> node [ </font><font color="#0000aa">set</font><font color="#000000"> connectedList </font><font color="#660096">lput</font><font color="#000000"> j connectedList ] ] 
            </font><font color="#0000aa">set</font><font color="#000000"> j j </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">  ] 
         </font><font color="#5a5a5a">;ask node [output-show connectedList]</font><font color="#000000">
         </font><font color="#0000aa">set</font><font color="#000000"> i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> 
         ]
  
</font><font color="#007f69">end</font><font color="#000000">
  


</font><font color="#007f69">to</font><font color="#000000"> go
   
    Setup  
   
    </font><font color="#0000aa">ifelse</font><font color="#000000"> Scenario </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;Minneapolis skway&quot;</font><font color="#000000">
    [ </font><font color="#0000aa">ask</font><font color="#000000"> simulinks [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">] runSkwaynetwork ]
    [ </font><font color="#0000aa">ask</font><font color="#000000"> roads [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">] runGridcitynetwork]
    
  
</font><font color="#007f69">end</font><font color="#000000"> 

</font><font color="#007f69">to</font><font color="#000000"> runSkwaynetwork
   </font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#963700">0</font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> previouslinks </font><font color="#963700">0</font><font color="#000000">  
    </font><font color="#0000aa">while</font><font color="#000000"> [ i </font><font color="#660096">&lt;</font><font color="#000000"> rounds ]
   [
      </font><font color="#0000aa">ifelse</font><font color="#000000"> i </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">40</font><font color="#000000">
      [ </font><font color="#0000aa">ask</font><font color="#000000"> buildings [</font><font color="#0000aa">set</font><font color="#000000"> space (</font><font color="#660096">item</font><font color="#000000"> i space-list) ]  ] 
      [</font><font color="#0000aa">ask</font><font color="#000000"> buildings [</font><font color="#0000aa">set</font><font color="#000000"> space </font><font color="#660096">last</font><font color="#000000"> space-list ] ]
      begin-build-skyways
      plot-nodes
      </font><font color="#0000aa">set</font><font color="#000000"> i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> runGridcitynetwork
  </font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#963700">0</font><font color="#000000">
  </font><font color="#0000aa">while</font><font color="#000000"> [ i </font><font color="#660096">&lt;</font><font color="#000000"> rounds ]
  [
     begin-build-gridnetwork
     plot-nodes
     </font><font color="#0000aa">set</font><font color="#000000"> i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">  
  ]
  
</font><font color="#007f69">end</font><font color="#000000"> 


</font><font color="#007f69">to</font><font color="#000000"> begin-build-skyways
    </font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> p </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> t </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> dist </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> id </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> connectNode </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> tickIndex </font><font color="#963700">false</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> sequence []
    </font><font color="#0000aa">let</font><font color="#000000"> node-count </font><font color="#660096">count</font><font color="#000000"> buildings
    </font><font color="#0000aa">ask</font><font color="#000000"> buildings [</font><font color="#0000aa">set</font><font color="#000000"> accessiblity </font><font color="#963700">0</font><font color="#000000">  </font><font color="#0000aa">set</font><font color="#000000"> marginalProfitlist [] </font><font color="#0000aa">set</font><font color="#000000"> distance-from-other-buildings [] </font><font color="#0000aa">set</font><font color="#000000"> shortest-path-nodes  []  </font><font color="#0000aa">set</font><font color="#000000"> nodelist [] </font><font color="#0000aa">set</font><font color="#000000"> matchratio-list []]
    
    </font><font color="#0000aa">ask</font><font color="#000000"> buildings [
      initialize-distances-among-buildings
      find-building-path-lengths [</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000">
      </font><font color="#0000aa">let</font><font color="#000000"> accessiblity_no_newlink accessiblity 
      </font><font color="#0000aa">let</font><font color="#000000"> m </font><font color="#963700">0</font><font color="#000000">
      </font><font color="#0000aa">while</font><font color="#000000"> [m </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#660096">length</font><font color="#000000"> connectedlist]
      [
           </font><font color="#0000aa">set</font><font color="#000000"> t </font><font color="#660096">item</font><font color="#000000"> m connectedList
           </font><font color="#0000aa">if</font><font color="#000000"> [ simulink-neighbor? building t ] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000">  </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000"> </font><font color="#5a5a5a">;and id != t</font><font color="#000000">
           [ create-simulink-with building t </font><font color="#5a5a5a">;set color red </font><font color="#000000">
             </font><font color="#5a5a5a">;output-show &quot;enter here&quot;</font><font color="#000000">
             find-distance-to-adjacent-connected-buildings [</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000">
             find-building-path-lengths [</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000">
             </font><font color="#0000aa">let</font><font color="#000000"> cost ( </font><font color="#660096">distance</font><font color="#000000"> (building t) </font><font color="#660096">*</font><font color="#000000"> unitedgecost )
             </font><font color="#0000aa">set</font><font color="#000000"> marginalProfitlist </font><font color="#660096">lput</font><font color="#000000"> (accessiblity </font><font color="#660096">-</font><font color="#000000"> accessiblity_no_newlink </font><font color="#660096">-</font><font color="#000000"> cost) marginalProfitlist
             </font><font color="#0000aa">output-show</font><font color="#000000"> </font><font color="#963700">&quot;accessiblity&quot;</font><font color="#000000">
             </font><font color="#0000aa">output-show</font><font color="#000000"> accessiblity
             </font><font color="#0000aa">set</font><font color="#000000"> nodelist </font><font color="#660096">lput</font><font color="#000000"> t nodelist
             </font><font color="#0000aa">ask</font><font color="#000000"> simulink ([</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000"> ) t [</font><font color="#0000aa">die</font><font color="#000000">]
             </font><font color="#5a5a5a">;ask my-simulinks with [other-end = t] [die]</font><font color="#000000">
           ] 
             
        </font><font color="#0000aa">set</font><font color="#000000"> m m </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">  ]
      
      </font><font color="#0000aa">if</font><font color="#000000"> marginalProfitlist </font><font color="#660096">!=</font><font color="#000000"> [] </font><font color="#660096">and</font><font color="#000000"> nodelist </font><font color="#660096">!=</font><font color="#000000"> []
      [
         </font><font color="#0000aa">if</font><font color="#000000">  (</font><font color="#660096">max</font><font color="#000000"> marginalProfitlist) </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">
         [
            </font><font color="#0000aa">let</font><font color="#000000"> maxvalue (</font><font color="#660096">max</font><font color="#000000"> marginalProfitlist)
            </font><font color="#0000aa">set</font><font color="#000000"> p (</font><font color="#660096">position</font><font color="#000000"> maxvalue marginalProfitlist) 
            </font><font color="#0000aa">let</font><font color="#000000"> node1 </font><font color="#660096">item</font><font color="#000000"> p nodelist
            create-simulink-with building node1 [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">]
            </font><font color="#0000aa">set</font><font color="#000000"> connect </font><font color="#963700">true</font><font color="#000000">
            </font><font color="#0000aa">ask</font><font color="#000000"> building node1 [</font><font color="#0000aa">set</font><font color="#000000"> connect </font><font color="#963700">true</font><font color="#000000">]]]]        
    
    </font><font color="#0000aa">tick</font><font color="#000000">   
</font><font color="#007f69">end</font><font color="#000000">


</font><font color="#007f69">to</font><font color="#000000"> initialize-distances-among-buildings
  
 </font><font color="#5a5a5a">;; initlialize the initialize-distance-set for all buildings</font><font color="#000000">
  </font><font color="#0000aa">ask</font><font color="#000000"> buildings [</font><font color="#0000aa">set</font><font color="#000000"> distance-from-other-buildings [] ]
  </font><font color="#0000aa">set</font><font color="#000000"> infinity </font><font color="#963700">9999999999</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#963700">0</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> j </font><font color="#963700">0</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> k </font><font color="#963700">0</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> node1 </font><font color="#660096">one-of</font><font color="#000000"> buildings
  </font><font color="#0000aa">let</font><font color="#000000"> node2 </font><font color="#660096">one-of</font><font color="#000000"> buildings
  </font><font color="#0000aa">let</font><font color="#000000"> node-count </font><font color="#660096">count</font><font color="#000000"> buildings
  </font><font color="#5a5a5a">;; initialize the distance lists</font><font color="#000000">
  </font><font color="#0000aa">while</font><font color="#000000"> [i </font><font color="#660096">&lt;</font><font color="#000000"> node-count]
  [
    </font><font color="#0000aa">set</font><font color="#000000"> j </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">while</font><font color="#000000"> [j </font><font color="#660096">&lt;</font><font color="#000000"> node-count]
    [
      </font><font color="#0000aa">set</font><font color="#000000"> node1 building i
      </font><font color="#0000aa">set</font><font color="#000000"> node2 building j
      </font><font color="#5a5a5a">;; zero from a node to itself</font><font color="#000000">
      </font><font color="#0000aa">ifelse</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> j
      [ </font><font color="#0000aa">ask</font><font color="#000000"> node1 [ </font><font color="#0000aa">set</font><font color="#000000"> distance-from-other-buildings </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> distance-from-other-buildings ]]
      [
      
        </font><font color="#5a5a5a">;; if two nodes are connected, set the distance to be zero because there is no need to build it again;;</font><font color="#000000">
        </font><font color="#5a5a5a">;; although in some other cases we might want to use another variable to indicate them</font><font color="#000000">
        
          </font><font color="#5a5a5a">;[ link-neighbor? node1 ] of node2 </font><font color="#000000">
         </font><font color="#0000aa">ifelse</font><font color="#000000">  [ simulink-neighbor? node1 ] </font><font color="#660096">of</font><font color="#000000"> node2 </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000">
         [
            </font><font color="#0000aa">ask</font><font color="#000000"> node1 [  </font><font color="#0000aa">set</font><font color="#000000"> distance-from-other-buildings </font><font color="#660096">lput</font><font color="#000000"> infinity distance-from-other-buildings ]]
         [
            </font><font color="#0000aa">ask</font><font color="#000000"> node1 [  </font><font color="#0000aa">set</font><font color="#000000"> distance-from-other-buildings </font><font color="#660096">lput</font><font color="#000000"> (</font><font color="#660096">distance</font><font color="#000000"> node2) distance-from-other-buildings ]]]
      </font><font color="#0000aa">set</font><font color="#000000"> j j </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">  ]
      </font><font color="#0000aa">set</font><font color="#000000"> i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> ]
 
  

</font><font color="#007f69">end</font><font color="#000000"> 


</font><font color="#007f69">to</font><font color="#000000"> find-building-path-lengths [m]
 </font><font color="#5a5a5a">;; initialize </font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#963700">0</font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> j </font><font color="#963700">0</font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> v </font><font color="#963700">0</font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> u </font><font color="#963700">0</font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> temp </font><font color="#963700">0</font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> newdist </font><font color="#963700">0</font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> node-count </font><font color="#660096">count</font><font color="#000000"> buildings
   </font><font color="#0000aa">set</font><font color="#000000"> prev [] </font><font color="#5a5a5a">;; the precedent of each node</font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> index [] </font><font color="#5a5a5a">; an index indicating whether each node has been added to the graph (true) or not added to the graph (falso)</font><font color="#000000">
   
   </font><font color="#5a5a5a">;; initialization: set every distance to INFINITY until we discover a path </font><font color="#000000">
   </font><font color="#0000aa">while</font><font color="#000000"> [i </font><font color="#660096">&lt;</font><font color="#000000"> node-count]
   [
      </font><font color="#5a5a5a">;;set distance-from-other-turtles lput (item i [distance-from-immediate-nodes] of turtle m) distance-from-other-turtles </font><font color="#000000">
      </font><font color="#5a5a5a">;; keep track of whether the node has been searched or not. </font><font color="#000000">
      </font><font color="#0000aa">set</font><font color="#000000"> index </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000"> index
      </font><font color="#5a5a5a">;; if the distance infinity then put 0 as the initial value, otherwise put the distance</font><font color="#000000">
      </font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">item</font><font color="#000000"> i [distance-from-other-buildings] </font><font color="#660096">of</font><font color="#000000"> building m </font><font color="#660096">=</font><font color="#000000"> infinity 
         [</font><font color="#0000aa">set</font><font color="#000000"> prev </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> prev]
         [</font><font color="#0000aa">set</font><font color="#000000"> prev </font><font color="#660096">lput</font><font color="#000000"> m prev]
      </font><font color="#0000aa">set</font><font color="#000000"> i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
   ]   
 
   </font><font color="#5a5a5a">;;output-show prev</font><font color="#000000">
      </font><font color="#5a5a5a">;; distance for the source m to the source m is defined to be zero</font><font color="#000000">
   </font><font color="#5a5a5a">;;set distance-from-other-turtles replace-item m distance-from-other-turtles 0 </font><font color="#000000">
   
   </font><font color="#0000aa">set</font><font color="#000000"> index </font><font color="#660096">replace-item</font><font color="#000000"> m index </font><font color="#963700">true</font><font color="#000000">  </font><font color="#5a5a5a">;; having been searched</font><font color="#000000">

   </font><font color="#5a5a5a">;; this loop corresponds to sending out the explorers walking the paths, where</font><font color="#000000">
   </font><font color="#5a5a5a">;; the step of picking &quot;the vertex, v, with the shorest path to s&quot; corresponds</font><font color="#000000">
   </font><font color="#5a5a5a">;; to an explorer arriving at an unexplored vertex</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> i </font><font color="#963700">0</font><font color="#000000">
   </font><font color="#0000aa">while</font><font color="#000000"> [i </font><font color="#660096">&lt;</font><font color="#000000"> node-count ]
   [
      </font><font color="#5a5a5a">;;find the vertex v in set-of-nodes with smallest dist[] []</font><font color="#000000">
      
      </font><font color="#0000aa">set</font><font color="#000000"> temp infinity 
      </font><font color="#0000aa">set</font><font color="#000000"> u m 
      </font><font color="#0000aa">set</font><font color="#000000"> j </font><font color="#963700">0</font><font color="#000000">
      
      </font><font color="#0000aa">while</font><font color="#000000"> [j </font><font color="#660096">&lt;</font><font color="#000000"> node-count]
      [ 
         </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> j index </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> j [distance-from-other-buildings] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> m </font><font color="#660096">&lt;</font><font color="#000000"> temp )
         [ 
             </font><font color="#0000aa">set</font><font color="#000000"> u j
             </font><font color="#0000aa">set</font><font color="#000000"> temp (</font><font color="#660096">item</font><font color="#000000"> j [distance-from-other-buildings] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> m)
         ]
         </font><font color="#0000aa">set</font><font color="#000000"> j j </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
      ]
      
      </font><font color="#0000aa">set</font><font color="#000000"> index </font><font color="#660096">replace-item</font><font color="#000000"> u index </font><font color="#963700">true</font><font color="#000000">
      
      </font><font color="#0000aa">set</font><font color="#000000"> j </font><font color="#963700">0</font><font color="#000000">
     
      </font><font color="#0000aa">while</font><font color="#000000"> [ j </font><font color="#660096">&lt;</font><font color="#000000"> node-count]
      [  
          </font><font color="#0000aa">if</font><font color="#000000">  ( </font><font color="#660096">item</font><font color="#000000"> j index </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000"> ) </font><font color="#660096">and</font><font color="#000000">  (</font><font color="#660096">item</font><font color="#000000"> j [distance-from-other-buildings] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> u </font><font color="#660096">&lt;</font><font color="#000000"> infinity)
          [
     
             </font><font color="#0000aa">set</font><font color="#000000"> newdist ( </font><font color="#660096">item</font><font color="#000000"> u [distance-from-other-buildings] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> m </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">item</font><font color="#000000"> j [distance-from-other-buildings] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> u )    
             </font><font color="#0000aa">if</font><font color="#000000"> newdist </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#660096">item</font><font color="#000000"> j [distance-from-other-buildings] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> m
             [
                
                </font><font color="#5a5a5a">; set [distance-from-other-turtles] of turtle m replace-item j [distance-from-other-turtles] of turtle m newdist</font><font color="#000000">
                </font><font color="#5a5a5a">;ask turtle m [ set distance-from-other-turtles  j [distance-from-other-turtles] of turtle m newdist ]</font><font color="#000000">
                </font><font color="#0000aa">ask</font><font color="#000000"> building m [</font><font color="#0000aa">set</font><font color="#000000"> distance-from-other-buildings </font><font color="#660096">replace-item</font><font color="#000000"> j [distance-from-other-buildings] </font><font color="#660096">of</font><font color="#000000"> building m newdist ]
                
                </font><font color="#0000aa">set</font><font color="#000000"> prev (</font><font color="#660096">replace-item</font><font color="#000000"> j prev u)
             ]
          ]
         
          </font><font color="#0000aa">set</font><font color="#000000"> j j </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
      ]
      
      </font><font color="#0000aa">set</font><font color="#000000"> i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
    ]  
  
    </font><font color="#5a5a5a">; output-show prev</font><font color="#000000">
    
   </font><font color="#5a5a5a">;; calculate the profit of the whole network for trutle m </font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> j </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> revenue </font><font color="#963700">0</font><font color="#000000">

   </font><font color="#0000aa">ask</font><font color="#000000"> building m [

      </font><font color="#0000aa">while</font><font color="#000000"> [j </font><font color="#660096">&lt;</font><font color="#000000"> node-count]
      [
         </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">item</font><font color="#000000"> j distance-from-other-buildings </font><font color="#660096">!=</font><font color="#000000"> infinity </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">item</font><font color="#000000"> j distance-from-other-buildings </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">
         [
            </font><font color="#5a5a5a">;; identify the id of node</font><font color="#000000">
            </font><font color="#5a5a5a">;; the value of a node is proportional to the number of emploe=yee in that node</font><font color="#000000">
           </font><font color="#0000aa">set</font><font color="#000000"> revenue revenue </font><font color="#660096">+</font><font color="#000000"> unitbenefit </font><font color="#660096">*</font><font color="#000000"> ([space] </font><font color="#660096">of</font><font color="#000000"> building m </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">240</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> j distance-from-other-buildings) </font><font color="#660096">^</font><font color="#000000"> (</font><font color="#660096">-</font><font color="#000000"> delta) ]  
           </font><font color="#0000aa">set</font><font color="#000000"> j j </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> ]
           </font><font color="#0000aa">set</font><font color="#000000"> accessiblity revenue ]  
</font><font color="#007f69">end</font><font color="#000000">


</font><font color="#007f69">to</font><font color="#000000"> find-distance-to-adjacent-connected-buildings [id]
  
  </font><font color="#0000aa">ask</font><font color="#000000"> building id [</font><font color="#0000aa">set</font><font color="#000000"> distance-from-other-buildings [] ]
  </font><font color="#0000aa">let</font><font color="#000000"> j </font><font color="#963700">0</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> node-count </font><font color="#660096">count</font><font color="#000000"> buildings
  
  </font><font color="#0000aa">while</font><font color="#000000"> [j </font><font color="#660096">&lt;</font><font color="#000000"> node-count]
  [
      </font><font color="#0000aa">ifelse</font><font color="#000000"> id </font><font color="#660096">=</font><font color="#000000"> j
      [
        </font><font color="#0000aa">ask</font><font color="#000000"> building id [ </font><font color="#0000aa">set</font><font color="#000000"> distance-from-other-buildings </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> distance-from-other-buildings ]
      ]
      [
          </font><font color="#0000aa">ifelse</font><font color="#000000">  [ simulink-neighbor? building id ] </font><font color="#660096">of</font><font color="#000000"> building j </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000">
          [
             </font><font color="#0000aa">ask</font><font color="#000000"> building id  [  </font><font color="#0000aa">set</font><font color="#000000"> distance-from-other-buildings </font><font color="#660096">lput</font><font color="#000000"> infinity distance-from-other-buildings ] ]
          [
             </font><font color="#0000aa">ask</font><font color="#000000"> building id   [  </font><font color="#0000aa">set</font><font color="#000000"> distance-from-other-buildings </font><font color="#660096">lput</font><font color="#000000"> (</font><font color="#660096">distance</font><font color="#000000"> building j) distance-from-other-buildings ]  ] ]  
    
      </font><font color="#0000aa">set</font><font color="#000000"> j j </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> ]

</font><font color="#007f69">end</font><font color="#000000">


</font><font color="#007f69">to</font><font color="#000000"> begin-build-gridnetwork
   </font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> j </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> k </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> p </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> s </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> t </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> dist </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> id </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> connectNode </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> sequence []
    </font><font color="#0000aa">let</font><font color="#000000"> node-count </font><font color="#660096">count</font><font color="#000000"> locations </font><font color="#5a5a5a">; count locations in the grid-like city</font><font color="#000000">
    </font><font color="#0000aa">ask</font><font color="#000000"> locations [</font><font color="#0000aa">set</font><font color="#000000"> accessiblity </font><font color="#963700">0</font><font color="#000000">  </font><font color="#0000aa">set</font><font color="#000000"> marginalProfitlist [] </font><font color="#0000aa">set</font><font color="#000000"> distance-from-other-locations [] </font><font color="#0000aa">set</font><font color="#000000"> shortest-path-nodes  []  </font><font color="#0000aa">set</font><font color="#000000"> nodelist [] </font><font color="#0000aa">set</font><font color="#000000"> matchratio-list []]
    
    </font><font color="#0000aa">ask</font><font color="#000000"> locations [
      initialize-distances-among-locations
      find-location-path-lengths [</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000">
      </font><font color="#0000aa">let</font><font color="#000000"> accessiblity_no_newlink accessiblity 
      </font><font color="#0000aa">let</font><font color="#000000"> m </font><font color="#963700">0</font><font color="#000000">
      </font><font color="#5a5a5a">;output-show distance-from-other-locations</font><font color="#000000">
      </font><font color="#0000aa">while</font><font color="#000000"> [m </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#660096">length</font><font color="#000000"> connectedlist]
      [
           </font><font color="#0000aa">set</font><font color="#000000"> t </font><font color="#660096">item</font><font color="#000000"> m connectedList
           </font><font color="#0000aa">if</font><font color="#000000"> [ road-neighbor? location t ] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000">  </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000"> </font><font color="#5a5a5a">;and id != t</font><font color="#000000">
           [ create-road-with location t </font><font color="#5a5a5a">;set color red </font><font color="#000000">
             find-distance-to-adjacent-connected-locations [</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000">
             </font><font color="#0000aa">output-show</font><font color="#000000"> </font><font color="#963700">&quot;distance from other locations&quot;</font><font color="#000000"> </font><font color="#0000aa">output-show</font><font color="#000000"> distance-from-other-locations
             find-location-path-lengths [</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000">
             </font><font color="#0000aa">set</font><font color="#000000"> marginalProfitlist </font><font color="#660096">lput</font><font color="#000000"> (accessiblity </font><font color="#660096">-</font><font color="#000000"> accessiblity_no_newlink </font><font color="#660096">-</font><font color="#000000"> newedgecost) marginalProfitlist
             </font><font color="#0000aa">output-show</font><font color="#000000"> </font><font color="#963700">&quot;margial profit&quot;</font><font color="#000000"> 
             </font><font color="#0000aa">output-show</font><font color="#000000"> (accessiblity </font><font color="#660096">-</font><font color="#000000"> accessiblity_no_newlink </font><font color="#660096">-</font><font color="#000000"> newedgecost)
             </font><font color="#0000aa">set</font><font color="#000000"> nodelist </font><font color="#660096">lput</font><font color="#000000"> t nodelist
             </font><font color="#0000aa">ask</font><font color="#000000"> road ([</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000"> ) t [</font><font color="#0000aa">die</font><font color="#000000">]
           ] 
             
        </font><font color="#0000aa">set</font><font color="#000000"> m m </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">  ]
      
      </font><font color="#0000aa">if</font><font color="#000000"> marginalProfitlist </font><font color="#660096">!=</font><font color="#000000"> [] </font><font color="#660096">and</font><font color="#000000"> nodelist </font><font color="#660096">!=</font><font color="#000000"> []
      [
         </font><font color="#0000aa">if</font><font color="#000000">  (</font><font color="#660096">max</font><font color="#000000"> marginalProfitlist) </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">
         [
            </font><font color="#0000aa">let</font><font color="#000000"> maxvalue (</font><font color="#660096">max</font><font color="#000000"> marginalProfitlist)
            </font><font color="#0000aa">set</font><font color="#000000"> p (</font><font color="#660096">position</font><font color="#000000"> maxvalue marginalProfitlist) 
            </font><font color="#0000aa">let</font><font color="#000000"> node1 </font><font color="#660096">item</font><font color="#000000"> p nodelist
            create-road-with location node1 [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">]
            </font><font color="#0000aa">set</font><font color="#000000"> connect </font><font color="#963700">true</font><font color="#000000">
            </font><font color="#0000aa">ask</font><font color="#000000"> location node1 [</font><font color="#0000aa">set</font><font color="#000000"> connect </font><font color="#963700">true</font><font color="#000000">]]]]        
    
    </font><font color="#0000aa">tick</font><font color="#000000"> 
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> initialize-distances-among-locations
   </font><font color="#0000aa">set</font><font color="#000000"> infinity </font><font color="#963700">9999999999</font><font color="#000000">
   </font><font color="#0000aa">ask</font><font color="#000000"> locations  [</font><font color="#0000aa">set</font><font color="#000000"> distance-from-other-locations [] ]
   </font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#963700">0</font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> j </font><font color="#963700">0</font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> k </font><font color="#963700">0</font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> node1 </font><font color="#660096">one-of</font><font color="#000000"> locations
   </font><font color="#0000aa">let</font><font color="#000000"> node2 </font><font color="#660096">one-of</font><font color="#000000"> locations
   </font><font color="#0000aa">let</font><font color="#000000"> node-count </font><font color="#660096">count</font><font color="#000000"> locations
  </font><font color="#0000aa">while</font><font color="#000000"> [i </font><font color="#660096">&lt;</font><font color="#000000"> node-count]
  [
    </font><font color="#0000aa">set</font><font color="#000000"> j </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">while</font><font color="#000000"> [j </font><font color="#660096">&lt;</font><font color="#000000"> node-count]
    [
      </font><font color="#0000aa">set</font><font color="#000000"> node1 location i
      </font><font color="#0000aa">set</font><font color="#000000"> node2 location j
      </font><font color="#5a5a5a">;; zero from a node to itself</font><font color="#000000">
      </font><font color="#0000aa">ifelse</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> j
      [ </font><font color="#0000aa">ask</font><font color="#000000"> node1 [ </font><font color="#0000aa">set</font><font color="#000000"> distance-from-other-locations </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> distance-from-other-locations ]]
      [

         </font><font color="#0000aa">ifelse</font><font color="#000000">  [ road-neighbor? node1 ] </font><font color="#660096">of</font><font color="#000000"> node2 </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000">
         [
            </font><font color="#0000aa">ask</font><font color="#000000"> node1 [  </font><font color="#0000aa">set</font><font color="#000000"> distance-from-other-locations </font><font color="#660096">lput</font><font color="#000000"> infinity distance-from-other-locations ]]
         [
            </font><font color="#0000aa">ask</font><font color="#000000"> node1 [  
               </font><font color="#0000aa">let</font><font color="#000000"> dist (</font><font color="#660096">distance</font><font color="#000000"> node2)
               </font><font color="#5a5a5a">;output-show &quot;distance&quot;  output-show  dist </font><font color="#000000">
               </font><font color="#0000aa">set</font><font color="#000000"> distance-from-other-locations </font><font color="#660096">lput</font><font color="#000000"> dist distance-from-other-locations ]]]
      </font><font color="#0000aa">set</font><font color="#000000"> j j </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">  ]
      </font><font color="#0000aa">set</font><font color="#000000"> i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> ]   
  
   </font><font color="#5a5a5a">;ask locations [output-show distance-from-other-locations ]</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000"> 


</font><font color="#5a5a5a">; change a name for that..</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> find-location-path-lengths [m]
   </font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#963700">0</font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> j </font><font color="#963700">0</font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> v </font><font color="#963700">0</font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> u </font><font color="#963700">0</font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> temp </font><font color="#963700">0</font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> newdist </font><font color="#963700">0</font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> node-count </font><font color="#660096">count</font><font color="#000000"> locations
   </font><font color="#0000aa">set</font><font color="#000000"> infinity </font><font color="#963700">9999999999</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> prev [] </font><font color="#5a5a5a">;; the precedent of each node</font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> index [] </font><font color="#5a5a5a">; an index indicating whether each node has been added to the graph (true) or not added to the graph (falso)</font><font color="#000000">
   </font><font color="#0000aa">while</font><font color="#000000"> [i </font><font color="#660096">&lt;</font><font color="#000000"> node-count]
   [ 
      </font><font color="#0000aa">set</font><font color="#000000"> index </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000"> index
      </font><font color="#5a5a5a">;; if the distance infinity then put 0 as the initial value, otherwise put the distance</font><font color="#000000">
      </font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">item</font><font color="#000000"> i [distance-from-other-locations] </font><font color="#660096">of</font><font color="#000000"> location m </font><font color="#660096">=</font><font color="#000000"> infinity 
         [</font><font color="#0000aa">set</font><font color="#000000"> prev </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> prev]
         [</font><font color="#0000aa">set</font><font color="#000000"> prev </font><font color="#660096">lput</font><font color="#000000"> m prev]
      </font><font color="#0000aa">set</font><font color="#000000"> i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
   ]
   
   </font><font color="#0000aa">set</font><font color="#000000"> index </font><font color="#660096">replace-item</font><font color="#000000"> m index </font><font color="#963700">true</font><font color="#000000">  </font><font color="#5a5a5a">;; having been searched</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> i </font><font color="#963700">0</font><font color="#000000">
   </font><font color="#0000aa">while</font><font color="#000000"> [i </font><font color="#660096">&lt;</font><font color="#000000"> node-count ]
   [

      </font><font color="#0000aa">set</font><font color="#000000"> temp infinity 
      </font><font color="#0000aa">set</font><font color="#000000"> u m 
      </font><font color="#0000aa">set</font><font color="#000000"> j </font><font color="#963700">0</font><font color="#000000">
      
      </font><font color="#0000aa">while</font><font color="#000000"> [j </font><font color="#660096">&lt;</font><font color="#000000"> node-count]
      [ 
         </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> j index </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> j [distance-from-other-locations] </font><font color="#660096">of</font><font color="#000000"> location m </font><font color="#660096">&lt;</font><font color="#000000"> temp )
         [ 
             </font><font color="#0000aa">set</font><font color="#000000"> u j
             </font><font color="#0000aa">set</font><font color="#000000"> temp (</font><font color="#660096">item</font><font color="#000000"> j [distance-from-other-locations] </font><font color="#660096">of</font><font color="#000000"> location m)
         ]
         </font><font color="#0000aa">set</font><font color="#000000"> j j </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
      ]
      
      </font><font color="#0000aa">set</font><font color="#000000"> index </font><font color="#660096">replace-item</font><font color="#000000"> u index </font><font color="#963700">true</font><font color="#000000">
      
      </font><font color="#0000aa">set</font><font color="#000000"> j </font><font color="#963700">0</font><font color="#000000">
     
      </font><font color="#0000aa">while</font><font color="#000000"> [ j </font><font color="#660096">&lt;</font><font color="#000000"> node-count]
      [  
          </font><font color="#0000aa">if</font><font color="#000000">  ( </font><font color="#660096">item</font><font color="#000000"> j index </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000"> ) </font><font color="#660096">and</font><font color="#000000">  (</font><font color="#660096">item</font><font color="#000000"> j [distance-from-other-locations] </font><font color="#660096">of</font><font color="#000000"> location u </font><font color="#660096">&lt;</font><font color="#000000"> infinity)
          [
     
             </font><font color="#0000aa">set</font><font color="#000000"> newdist ( </font><font color="#660096">item</font><font color="#000000"> u [distance-from-other-locations] </font><font color="#660096">of</font><font color="#000000"> location m </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">item</font><font color="#000000"> j [distance-from-other-locations] </font><font color="#660096">of</font><font color="#000000"> location u )    
             </font><font color="#0000aa">if</font><font color="#000000"> newdist </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#660096">item</font><font color="#000000"> j [distance-from-other-locations] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> m
             [
   
                </font><font color="#0000aa">ask</font><font color="#000000"> location m [</font><font color="#0000aa">set</font><font color="#000000"> distance-from-other-locations </font><font color="#660096">replace-item</font><font color="#000000"> j [distance-from-other-locations] </font><font color="#660096">of</font><font color="#000000"> location m newdist ]
                
                </font><font color="#0000aa">set</font><font color="#000000"> prev (</font><font color="#660096">replace-item</font><font color="#000000"> j prev u)
             ]
          ]
         
          </font><font color="#0000aa">set</font><font color="#000000"> j j </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
      ]
      
      </font><font color="#0000aa">set</font><font color="#000000"> i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
    ]  
   
   </font><font color="#5a5a5a">;ask location m </font><font color="#000000">
   </font><font color="#5a5a5a">;[output-show &quot;location m&quot;</font><font color="#000000">
   </font><font color="#5a5a5a">; output-show distance-from-other-locations]</font><font color="#000000">
  
   </font><font color="#5a5a5a">;; calculate the profit of the whole network for location</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> j </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> revenue </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">ask</font><font color="#000000"> location m [
    </font><font color="#0000aa">while</font><font color="#000000"> [j </font><font color="#660096">&lt;</font><font color="#000000"> node-count]
      [
         </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">item</font><font color="#000000"> j distance-from-other-locations </font><font color="#660096">!=</font><font color="#000000"> infinity </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">item</font><font color="#000000"> j distance-from-other-locations </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">
         [ 
           
             </font><font color="#0000aa">ifelse</font><font color="#000000"> Scenario </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;Single-center grid-like city&quot;</font><font color="#000000">
             [ 
                </font><font color="#0000aa">ifelse</font><font color="#000000">  [</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> [</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j  </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">    
                [ </font><font color="#0000aa">set</font><font color="#000000"> revenue revenue </font><font color="#660096">+</font><font color="#000000">  w_center </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> j distance-from-other-locations ) </font><font color="#660096">^</font><font color="#000000"> (</font><font color="#660096">-</font><font color="#000000"> delta)]
                [ </font><font color="#0000aa">set</font><font color="#000000"> revenue revenue </font><font color="#660096">+</font><font color="#000000">  w </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> j distance-from-other-locations) </font><font color="#660096">^</font><font color="#000000"> (</font><font color="#660096">-</font><font color="#000000"> delta) ] ]
             [
                </font><font color="#0000aa">ifelse</font><font color="#000000"> Scenario </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;Two-center grid-like city&quot;</font><font color="#000000">
                [
                    </font><font color="#0000aa">ifelse</font><font color="#000000"> ( [</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">-1</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale  </font><font color="#660096">and</font><font color="#000000"> [</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000"> ( [</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j </font><font color="#660096">=</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale </font><font color="#660096">and</font><font color="#000000"> [</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">)
                    [ </font><font color="#0000aa">set</font><font color="#000000"> revenue revenue </font><font color="#660096">+</font><font color="#000000">  w_center </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> j distance-from-other-locations ) </font><font color="#660096">^</font><font color="#000000"> (</font><font color="#660096">-</font><font color="#000000"> delta)]
                    [ </font><font color="#0000aa">set</font><font color="#000000"> revenue revenue </font><font color="#660096">+</font><font color="#000000">  w </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> j distance-from-other-locations) </font><font color="#660096">^</font><font color="#000000"> (</font><font color="#660096">-</font><font color="#000000"> delta) ] ]
                [
                    </font><font color="#0000aa">ifelse</font><font color="#000000"> Scenario </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;Four-center grid-like city&quot;</font><font color="#000000">
                    [ 
                       </font><font color="#0000aa">ifelse</font><font color="#000000"> ([</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">-1</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale </font><font color="#660096">and</font><font color="#000000"> [</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000"> ( [</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j </font><font color="#660096">=</font><font color="#000000">  </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale </font><font color="#660096">and</font><font color="#000000"> [</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) 
                       </font><font color="#660096">or</font><font color="#000000"> ([</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> [</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">-1</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale) </font><font color="#660096">or</font><font color="#000000"> ([</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j  </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> [</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j </font><font color="#660096">=</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale)  
                       [ </font><font color="#0000aa">set</font><font color="#000000"> revenue revenue </font><font color="#660096">+</font><font color="#000000">  w_center </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> j distance-from-other-locations ) </font><font color="#660096">^</font><font color="#000000"> (</font><font color="#660096">-</font><font color="#000000"> delta)]
                       [ </font><font color="#0000aa">set</font><font color="#000000"> revenue revenue </font><font color="#660096">+</font><font color="#000000">  w </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> j distance-from-other-locations) </font><font color="#660096">^</font><font color="#000000"> (</font><font color="#660096">-</font><font color="#000000"> delta) ] ]
                     [
                       </font><font color="#0000aa">if</font><font color="#000000"> Scenario </font><font color="#660096">=</font><font color="#000000">  </font><font color="#963700">&quot;Nine-center grid-like city&quot;</font><font color="#000000">
                       [
                          </font><font color="#0000aa">ifelse</font><font color="#000000"> ([</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j  </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">-1</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale </font><font color="#660096">and</font><font color="#000000"> [</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j  </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000"> 
                            ([</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j  </font><font color="#660096">=</font><font color="#000000">  </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale </font><font color="#660096">and</font><font color="#000000">[ </font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j  </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000">
                            ([</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j  </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> [</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j  </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">-1</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale) </font><font color="#660096">or</font><font color="#000000"> 
                            ([</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j  </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> [</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j  </font><font color="#660096">=</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale) </font><font color="#660096">or</font><font color="#000000"> 
                            ([</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">-1</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale </font><font color="#660096">and</font><font color="#000000"> [</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j  </font><font color="#660096">=</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale) </font><font color="#660096">or</font><font color="#000000"> 
                            ([</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j  </font><font color="#660096">=</font><font color="#000000">  </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale </font><font color="#660096">and</font><font color="#000000"> [</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j  </font><font color="#660096">=</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale) </font><font color="#660096">or</font><font color="#000000"> 
                            ( [</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j  </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> [</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j  </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000">
                            ([</font><font color="#660096">xcor</font><font color="#000000">]  </font><font color="#660096">of</font><font color="#000000"> location j </font><font color="#660096">=</font><font color="#000000">  </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale </font><font color="#660096">and</font><font color="#000000"> [</font><font color="#660096">ycor</font><font color="#000000">]  </font><font color="#660096">of</font><font color="#000000"> location j </font><font color="#660096">=</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale) </font><font color="#660096">or</font><font color="#000000"> 
                            ([</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j </font><font color="#660096">=</font><font color="#000000">  </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale </font><font color="#660096">and</font><font color="#000000"> [</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">-1</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale) </font><font color="#660096">or</font><font color="#000000"> 
                            ([</font><font color="#660096">xcor</font><font color="#000000">]  </font><font color="#660096">of</font><font color="#000000"> location j  </font><font color="#660096">=</font><font color="#000000">  </font><font color="#963700">-1</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale </font><font color="#660096">and</font><font color="#000000"> [</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> location j </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">-1</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000">(grid-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> scale)
                            [ </font><font color="#0000aa">set</font><font color="#000000"> revenue revenue </font><font color="#660096">+</font><font color="#000000">  w_center </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> j distance-from-other-locations ) </font><font color="#660096">^</font><font color="#000000"> (</font><font color="#660096">-</font><font color="#000000"> delta)]
                            [ </font><font color="#0000aa">set</font><font color="#000000"> revenue revenue </font><font color="#660096">+</font><font color="#000000">  w </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> j distance-from-other-locations) </font><font color="#660096">^</font><font color="#000000"> (</font><font color="#660096">-</font><font color="#000000"> delta) ]]]]]]
           </font><font color="#0000aa">set</font><font color="#000000"> j j </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> ]
           </font><font color="#0000aa">set</font><font color="#000000"> accessiblity revenue
           </font><font color="#0000aa">output-show</font><font color="#000000"> </font><font color="#963700">&quot;accessibility&quot;</font><font color="#000000">
           </font><font color="#0000aa">output-show</font><font color="#000000"> accessiblity]  

</font><font color="#007f69">end</font><font color="#000000">


</font><font color="#007f69">to</font><font color="#000000"> find-distance-to-adjacent-connected-locations [id]
  
  </font><font color="#0000aa">ask</font><font color="#000000"> location id [</font><font color="#0000aa">set</font><font color="#000000"> distance-from-other-locations [] ]
  </font><font color="#0000aa">let</font><font color="#000000"> j </font><font color="#963700">0</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> node-count </font><font color="#660096">count</font><font color="#000000"> locations
  
  </font><font color="#0000aa">while</font><font color="#000000"> [j </font><font color="#660096">&lt;</font><font color="#000000"> node-count]
  [
      </font><font color="#0000aa">ifelse</font><font color="#000000"> id </font><font color="#660096">=</font><font color="#000000"> j
      [
        </font><font color="#0000aa">ask</font><font color="#000000"> location id [ </font><font color="#0000aa">set</font><font color="#000000"> distance-from-other-locations </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> distance-from-other-locations ]
      ]
      [
          </font><font color="#0000aa">ifelse</font><font color="#000000">  [ road-neighbor? location id ] </font><font color="#660096">of</font><font color="#000000"> location j </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000">
          [ </font><font color="#0000aa">ask</font><font color="#000000"> location id  [  </font><font color="#0000aa">set</font><font color="#000000"> distance-from-other-locations </font><font color="#660096">lput</font><font color="#000000"> infinity distance-from-other-locations ] ]
          [ </font><font color="#0000aa">ask</font><font color="#000000"> location  id   [  </font><font color="#0000aa">set</font><font color="#000000"> distance-from-other-locations </font><font color="#660096">lput</font><font color="#000000"> (</font><font color="#660096">distance</font><font color="#000000"> location j) distance-from-other-locations ]  ] ]  
    
      </font><font color="#0000aa">set</font><font color="#000000"> j j </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> ]
  
</font><font color="#007f69">end</font><font color="#000000"> 

</font><font color="#5a5a5a">; plot number of connected buildings or locations </font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> plot-nodes

  </font><font color="#0000aa">set-current-plot</font><font color="#000000"> </font><font color="#963700">&quot;Num of connected nodes&quot;</font><font color="#000000">  
  </font><font color="#0000aa">ifelse</font><font color="#000000"> Scenario </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;Minneapolis skway&quot;</font><font color="#000000">
  [ </font><font color="#0000aa">set-plot-y-range</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> (</font><font color="#660096">count</font><font color="#000000"> buildings </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">)
    </font><font color="#0000aa">plot</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> buildings </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">count</font><font color="#000000"> simulink-neighbors </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> ] ]
  [  </font><font color="#0000aa">set-plot-y-range</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> (</font><font color="#660096">count</font><font color="#000000"> locations </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">)
    </font><font color="#0000aa">plot</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> locations </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">count</font><font color="#000000"> road-neighbors </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> ] ]
  
  </font><font color="#0000aa">set-current-plot</font><font color="#000000"> </font><font color="#963700">&quot;Num of links&quot;</font><font color="#000000">  
  </font><font color="#0000aa">ifelse</font><font color="#000000"> Scenario </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;Minneapolis skway&quot;</font><font color="#000000">
  [ </font><font color="#0000aa">plot</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> simulinks ]
  [ </font><font color="#0000aa">plot</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> roads ]
 
 
  </font><font color="#0000aa">set-current-plot</font><font color="#000000"> </font><font color="#963700">&quot;Meshedness&quot;</font><font color="#000000">
  </font><font color="#0000aa">ifelse</font><font color="#000000"> Scenario </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;Minneapolis skway&quot;</font><font color="#000000">
   [
      </font><font color="#0000aa">let</font><font color="#000000"> m </font><font color="#660096">count</font><font color="#000000"> simulinks
      </font><font color="#0000aa">let</font><font color="#000000"> n </font><font color="#660096">count</font><font color="#000000"> buildings
      </font><font color="#0000aa">plot</font><font color="#000000"> (m </font><font color="#660096">-</font><font color="#000000"> n </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)</font><font color="#660096">/</font><font color="#000000">(</font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> n </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000">)
   ]
   [ </font><font color="#0000aa">let</font><font color="#000000"> m </font><font color="#660096">count</font><font color="#000000"> roads
     </font><font color="#0000aa">let</font><font color="#000000"> n </font><font color="#660096">count</font><font color="#000000"> locations
     </font><font color="#0000aa">plot</font><font color="#000000"> (m </font><font color="#660096">-</font><font color="#000000"> n </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)</font><font color="#660096">/</font><font color="#000000">(</font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> n </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000">)
   ]
   
   
  </font><font color="#5a5a5a">; calculate the average number of connections in each round  </font><font color="#000000">
  </font><font color="#0000aa">set-current-plot</font><font color="#000000"> </font><font color="#963700">&quot;Average degree of connections&quot;</font><font color="#000000">
  </font><font color="#0000aa">ifelse</font><font color="#000000"> Scenario </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;Minneapolis skway&quot;</font><font color="#000000">
  [  </font><font color="#0000aa">let</font><font color="#000000"> dg </font><font color="#963700">0</font><font color="#000000">
     </font><font color="#0000aa">let</font><font color="#000000"> max-degree </font><font color="#660096">max</font><font color="#000000"> [</font><font color="#660096">count</font><font color="#000000"> simulink-neighbors] </font><font color="#660096">of</font><font color="#000000"> buildings
     </font><font color="#0000aa">set-plot-y-range</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> (max-degree </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) 
     </font><font color="#0000aa">ask</font><font color="#000000"> buildings [</font><font color="#0000aa">set</font><font color="#000000"> dg ( dg </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> simulink-neighbors)]
     </font><font color="#0000aa">plot</font><font color="#000000"> dg </font><font color="#660096">/</font><font color="#000000"> (</font><font color="#660096">count</font><font color="#000000"> buildings </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">count</font><font color="#000000"> simulink-neighbors </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> ] )
  ]
  [
     </font><font color="#0000aa">let</font><font color="#000000"> max-degree </font><font color="#660096">max</font><font color="#000000"> [</font><font color="#660096">count</font><font color="#000000"> road-neighbors] </font><font color="#660096">of</font><font color="#000000"> locations
     </font><font color="#0000aa">set-plot-y-range</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#963700">6</font><font color="#000000"> 
     </font><font color="#0000aa">let</font><font color="#000000"> dg </font><font color="#963700">0</font><font color="#000000">
     </font><font color="#0000aa">ask</font><font color="#000000"> locations [ </font><font color="#0000aa">set</font><font color="#000000"> dg ( dg </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> road-neighbors)]
     </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> roads </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [ </font><font color="#0000aa">plot</font><font color="#000000"> dg </font><font color="#660096">/</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> locations </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">count</font><font color="#000000"> road-neighbors </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> ] ] 
  ] 
   
  
  </font><font color="#0000aa">set-current-plot</font><font color="#000000"> </font><font color="#963700">&quot;Degree Distribution&quot;</font><font color="#000000">
  </font><font color="#0000aa">plot-pen-reset</font><font color="#000000">
  </font><font color="#0000aa">ifelse</font><font color="#000000"> Scenario </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;Minneapolis skway&quot;</font><font color="#000000">
  [  </font><font color="#0000aa">let</font><font color="#000000"> max-degree </font><font color="#660096">max</font><font color="#000000"> [</font><font color="#660096">count</font><font color="#000000"> simulink-neighbors] </font><font color="#660096">of</font><font color="#000000"> buildings
     </font><font color="#0000aa">set-plot-x-range</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> (max-degree </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)  </font><font color="#5a5a5a">;; + 1 to make room for the width of the last bar</font><font color="#000000">
       </font><font color="#0000aa">histogram</font><font color="#000000"> [</font><font color="#660096">count</font><font color="#000000"> simulink-neighbors] </font><font color="#660096">of</font><font color="#000000"> buildings </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">count</font><font color="#000000"> simulink-neighbors </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> ]]
  [ </font><font color="#0000aa">let</font><font color="#000000"> max-degree </font><font color="#660096">max</font><font color="#000000"> [</font><font color="#660096">count</font><font color="#000000"> road-neighbors] </font><font color="#660096">of</font><font color="#000000"> locations
     </font><font color="#0000aa">set-plot-x-range</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#963700">6</font><font color="#000000">  </font><font color="#5a5a5a">;; + 1 to make room for the width of the last bar</font><font color="#000000">
       </font><font color="#0000aa">histogram</font><font color="#000000"> [</font><font color="#660096">count</font><font color="#000000"> road-neighbors] </font><font color="#660096">of</font><font color="#000000"> locations </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">count</font><font color="#000000"> road-neighbors </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> ] ]  
  
  
  </font><font color="#0000aa">set-current-plot</font><font color="#000000"> </font><font color="#963700">&quot;Degree Distribution (log-log)&quot;</font><font color="#000000">
  </font><font color="#0000aa">plot-pen-reset</font><font color="#000000">  </font><font color="#5a5a5a">;; erase what we plotted before</font><font color="#000000">
  </font><font color="#5a5a5a">;; the way we create the network there is never a zero degree node,</font><font color="#000000">
  </font><font color="#5a5a5a">;; so start plotting at degree one</font><font color="#000000">
  </font><font color="#0000aa">ifelse</font><font color="#000000"> Scenario </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;Minneapolis skway&quot;</font><font color="#000000">
  [  </font><font color="#0000aa">let</font><font color="#000000"> degree </font><font color="#963700">1</font><font color="#000000">
     </font><font color="#0000aa">let</font><font color="#000000"> max-degree </font><font color="#660096">max</font><font color="#000000"> [</font><font color="#660096">count</font><font color="#000000"> simulink-neighbors] </font><font color="#660096">of</font><font color="#000000"> buildings
     </font><font color="#0000aa">while</font><font color="#000000"> [degree </font><font color="#660096">&lt;=</font><font color="#000000"> max-degree]
     [</font><font color="#0000aa">let</font><font color="#000000"> matches buildings </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">count</font><font color="#000000"> simulink-neighbors </font><font color="#660096">=</font><font color="#000000"> degree]
     </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> matches
     [ </font><font color="#0000aa">plotxy</font><font color="#000000"> </font><font color="#660096">log</font><font color="#000000"> degree </font><font color="#963700">10</font><font color="#000000">
               </font><font color="#660096">log</font><font color="#000000"> (</font><font color="#660096">count</font><font color="#000000"> matches) </font><font color="#963700">10</font><font color="#000000"> ]
      </font><font color="#0000aa">set</font><font color="#000000"> degree degree </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] ]
 [  </font><font color="#0000aa">let</font><font color="#000000"> degree </font><font color="#963700">1</font><font color="#000000">
     </font><font color="#0000aa">let</font><font color="#000000"> max-degree </font><font color="#660096">max</font><font color="#000000"> [</font><font color="#660096">count</font><font color="#000000"> road-neighbors] </font><font color="#660096">of</font><font color="#000000"> locations
     </font><font color="#0000aa">while</font><font color="#000000"> [degree </font><font color="#660096">&lt;=</font><font color="#000000"> max-degree]
     [</font><font color="#0000aa">let</font><font color="#000000"> matches locations </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">count</font><font color="#000000"> road-neighbors </font><font color="#660096">=</font><font color="#000000"> degree]
     </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> matches
     [ </font><font color="#0000aa">plotxy</font><font color="#000000"> </font><font color="#660096">log</font><font color="#000000"> degree </font><font color="#963700">10</font><font color="#000000">
               </font><font color="#660096">log</font><font color="#000000"> (</font><font color="#660096">count</font><font color="#000000"> matches) </font><font color="#963700">10</font><font color="#000000"> ]
      </font><font color="#0000aa">set</font><font color="#000000"> degree degree </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">]]  
  
  
   
  

</font><font color="#007f69">end</font><font color="#000000">
</font>
</pre>

</body>
</html>
